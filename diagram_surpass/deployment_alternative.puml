@startuml Infrastructure_Layout
skinparam node {
    BorderColor DarkSlateGray
    BackgroundColor LightCyan
}

title Travel Management System Infrastructure Layout

cloud "External Services" {
    [Payment Gateway] as PayGateway
    [Email Service Provider] as EmailSvc
    [SMS Gateway] as SMSGateway
}

node "Load Balancer" {
    [HAProxy] as Proxy
}

node "Application Cluster" {
    package "Primary Server" {
        [Nginx Web Server] as WebServer1
        [PHP-FPM] as PHP1
        [Session Handler] as Session1
        [Cache Manager] as Cache1
    }
    
    package "Backup Server" {
        [Nginx Web Server] as WebServer2
        [PHP-FPM] as PHP2
        [Session Handler] as Session2
        [Cache Manager] as Cache2
    }
}

cloud "Storage Services" {
    database "Primary Database" {
        frame "Master DB" {
            [User Data]
            [Program Data]
            [Transaction Records]
        }
    }
    
    database "Replica Database" {
        frame "Slave DB" {
            [Backup Data]
            [Archive]
        }
    }
    
    database "Document Store" {
        [Document Management System]
    }
}

node "Client Applications" {
    [Web Browser] as Browser
    [Mobile App] as Mobile
}

Browser --> Proxy
Mobile --> Proxy
Proxy --> WebServer1
Proxy --> WebServer2
WebServer1 --> PHP1
WebServer2 --> PHP2
PHP1 --> Cache1
PHP2 --> Cache2
PHP1 --> [User Data]
PHP2 --> [Backup Data]
PHP1 ..> PayGateway
PHP1 ..> EmailSvc
PHP1 ..> SMSGateway
Cache1 --> Session1
Cache2 --> Session2

@enduml
